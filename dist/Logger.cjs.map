{"version":3,"file":"Logger.cjs","sources":["../src/Logger.ts"],"sourcesContent":["import { Falsy, makeArray, MaybeArray } from './util';\n\n/** A function which handles logger messages. */\nexport interface Transport<LevelName extends keyof any = keyof any> {\n\t(contents: any[], levelName: LevelName, logger: Logger): void;\n}\n\n/**\n * Configuration for a logger. Defines the level names and the transports they\n * connect to.\n */\nexport type LoggerConfig = {\n\t[name in keyof any]: MaybeArray<Falsy | Transport>;\n}\n\n/** A function that logs things at a particular level. */\nexport interface LoggerFunction {\n\t/** Sends a message to all transports configured for this level. */\n\t(...contents: any[]): void;\n}\n\n/** An object with methods for each configured log level. */\nexport type Logger<LevelName extends keyof any = keyof any> = {\n\t[key in LevelName]: LoggerFunction;\n}\n\n/** Creates a logger from the given configuration. */\nexport function createLogger<T extends LoggerConfig>(config: T): Logger<keyof T> {\n\t// Create the object we'll fill with logger functions\n\tlet logger = {} as Logger<keyof T>;\n\n\t// Create logger functions for all configured levels and add them\n\t// NOTE: (keyof T)[] is safe to assert here since T is a type argument that\n\t//       exactly describes config. See also\n\t//       https://stackoverflow.com/a/55012175/1070107.\n\tfor (const level of Object.keys(config) as (keyof T)[]) {\n\t\t// Get the transport list as an array, filtering out falsy items\n\t\tconst transports = makeArray(config[level]).filter(val => !!val) as Transport<keyof T>[];\n\n\t\t// Create the logger function for this level\n\t\tconst loggerFunc: LoggerFunction = (...contents: any[]) => {\n\t\t\t// send message to all transports configured for this level\n\t\t\ttransports.forEach(transport => transport(contents, level, logger));\n\t\t};\n\n\t\tlogger[level] = loggerFunc;\n\t}\n\n\treturn logger;\n}\n"],"names":["makeArray"],"mappings":";;;;;;AA0BA;SACgB,YAAY,CAAyB,MAAS;;IAE7D,IAAI,MAAM,GAAG,EAAqB,CAAC;;;;;IAMnC,KAAK,MAAM,KAAK,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAgB,EAAE;;QAEvD,MAAM,UAAU,GAAGA,cAAS,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,CAAyB,CAAC;;QAGzF,MAAM,UAAU,GAAmB,CAAC,GAAG,QAAe;;YAErD,UAAU,CAAC,OAAO,CAAC,SAAS,IAAI,SAAS,CAAC,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC;SACpE,CAAC;QAEF,MAAM,CAAC,KAAK,CAAC,GAAG,UAAU,CAAC;KAC3B;IAED,OAAO,MAAM,CAAC;AACf;;;;"}